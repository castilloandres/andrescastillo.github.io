<!DOCTYPE HTML>

<html lang='en'>
  <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-64326807-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-64326807-3');
    </script>
    <title>Google's Mobile-Friendly Test tool: font size</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="shortcut icon" href="../../images/andres-castillo-think-outside-box.png" />
    <link rel="stylesheet" href="../../assets/css/main.css" />
    <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
    <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
  </head>
  <body>

    <!-- Page Wrapper -->
      <div id="page-wrapper">

        <!-- Menu -->
          <nav id="nav">
              <ul>
                <li><a href="../../index.html">Blog</a></li>
                <li><a href="../../projects.html">Projects</a></li>
                <li><a href="../../about.html">About</a></li>
                <!-- <li><a href="../../contact.html">Contact</a></li> -->
              </ul>
          </nav>

        <!-- Main -->
          <article id="main">
            <header style="background-image:url('../../images/blog/mobile-friendly/bad-font-size-background.png')">
              <h1>Reverse engineering Google's Mobile Friendly-Test Tool</h1>
              <p>7 experiments on font size detection</p>
            </header>
            <section class="wrapper style5">
              <div class="inner">
                <p>What font size should my page have on mobile devices? Does google take into account when analyzing on-page invisible text? opacity? display and visibility CSS properties?</p>

                <h3>A bit of context first.</h3>
                <p>It is very important to make your website readable from a mobile device since it is predicted that there will be 2.7 billion smartphone users in 2019:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/smartphone-users.png" class="image fit"><img src="../../images/blog/mobile-friendly/smartphone-users.png"></a>
                </div>
                <p class="source">• Source: https://www.statista.com/statistics/330695/number-of-smartphone-users-worldwide/</p>

                <p>It is recommended by Google that the font size of your site on a mobile device should be at least 12 pixels:</p>

                <div class="10u">
                  <a href="../../images/blog/mobile-friendly/lighthouse-docs.png" class="image fit"><img src="../../images/blog/mobile-friendly/lighthouse-docs.png"></a>
                </div>
                <p class="source">• Source: https://developers.google.com/web/tools/lighthouse/audits/font-sizes</p>

                <div class="10u">
                  <a href="../../images/blog/mobile-friendly/think-with-google-docs.png" class="image fit"><img src="../../images/blog/mobile-friendly/google-docs.png"></a>
                </div>
                <p class="source">• Source: https://www.thinkwithgoogle.com/intl/en-gb/consumer-insights/build-a-great-user-experience/</p>

                <p>You can test this first in a tool called "Lighthouse" that is a tool for improving the quality of a website. There is a particular section in Lighthouse that refers to the "Mobile Friendly Test" that is also a tool by Google to check the quality of your website but instead in mobile devices.</p>

                <div class="10u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/lighthouse.png" class="image fit"><img src="../../images/blog/mobile-friendly/lighthouse.png"></a>
                </div>

                <p>The interesting thing here is that the "Mobile Friendly Test" tool is NOT open sourced. So I decided to do some experiments regarding font size detection in mobile devices.</p>

                <h4>Experiment #1:</h4>
                <h5>What is a good font size?</h5>
                <p>I set a base text (1059 characters) in a plain HTML file and started changing the font size and running it against the Mobile-Friendly tool. Turns out that the minimum required font size so that the page passes the test is when setting it to >= 21px.</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/good-font-size.png" class="image fit"><img src="../../images/blog/mobile-friendly/good-font-size.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=REqe8liXkTVa8iMSVd5j4w" target="_blank">https://search.google.com/test/mobile-friendly?id=REqe8liXkTVa8iMSVd5j4w</p>

                <h4>Experiment #2:</h4>
                <h5>What is a bad font size?</h5>
                <p>Using the same base HTML file (1059 characters) I changed the font size to 20px and turns out that the page fails the font size test:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/bad-font-size.png" class="image fit"><img src="../../images/blog/mobile-friendly/bad-font-size.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=cFclgsqXxy--ZyQzxUvmMg" target="_blank">https://search.google.com/test/mobile-friendly?id=cFclgsqXxy--ZyQzxUvmMg</p>

                <h4>Experiment #3:</h4>
                <h5>Will adding a viewport fix anything?</h5>
                <p>Using the same base HTML file (1059 characters at 20 px) I added a viewport meta tag and it happens so that the page passes the font size test. So, again, remember the importance of the mobile viewport tag. The things it can do for such little effort:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/adding-viewport.png" class="image fit"><img src="../../images/blog/mobile-friendly/bad-font-size-with-viewport.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=q2GC-pEA57f4RQZvWluwUg" target="_blank">https://search.google.com/test/mobile-friendly?id=q2GC-pEA57f4RQZvWluwUg</p>

                <h4>Experiment #4:</h4>
                <h5>Is text with the same color as the background (a.k.a invisible text) considered in the font size test?</h5>
                <p>Using a plain HTML file with 1059 characters at 21px (a good font size) I added 5323 characters at 20px (bad font size) with the same color as the background which is roughly 83% of invisible text on the page. The result is that indeed invisible text is considered when analyzing on-page text:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/invisible-text.png" class="image fit"><img src="../../images/blog/mobile-friendly/invisible-text.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=CU1EYq60cJIwN7d71rPtVg" target="_blank">https://search.google.com/test/mobile-friendly?id=CU1EYq60cJIwN7d71rPtVg</p>

                <h4>Experiment #5:</h4>
                <h5>What about text with <code>opacity:0</code></h5>
                <p>I kept the same 1059 characters at 21px (good font size) and added 5323 characters  with <code>opacity:0</code> (83% invisible text) at 20px (bad font size). The result is the same as with Experiment #4. It failed:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/opacity-zero.png" class="image fit"><img src="../../images/blog/mobile-friendly/opacity-zero.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=oU4FWqss5p9yPQmSgVsKIA" target="_blank">https://search.google.com/test/mobile-friendly?id=oU4FWqss5p9yPQmSgVsKIA</p>

                <h4>Experiment #6:</h4>
                <h5>Let's try now with <code>visibility:hidden;</code></h5>
                <p>I kept the same 1059 characters at 21px (good font size) and added 5323 characters with <code>visibility:hidden;</code> (83% invisible text) at 20px (bad font size). The page passes the test so the text with the CSS property <code>visibility:hidden;</code> is NOT considered in the Mobile-Friendly test:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/visibility-hidden.png" class="image fit"><img src="../../images/blog/mobile-friendly/visibility-hidden.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=rw6ySrMeBceClojTVetOOA" target="_blank">https://search.google.com/test/mobile-friendly?id=rw6ySrMeBceClojTVetOOA</p>

                <h4>Experiment #7:</h4>
                <h5>Last one with <code>display:none;</code></h5>
                <p>With 1059 characters at 21px (good font size) and adding 5323 characters with <code>display:none;</code> (83% invisible text) at 20px (bad font size). The page passes the test so the text with CSS property <code>display:none;</code> is NOT considered in the Mobile-Friendly test:</p>

                <div class="6u 12u$(medium)">
                  <a href="../../images/blog/mobile-friendly/display-none.png" class="image fit"><img src="../../images/blog/mobile-friendly/display-none.png"></a>
                </div>
                <p class="source">• Source: <a href="https://search.google.com/test/mobile-friendly?id=jyYcBViQ6HLVydDMtXn70g" target="_blank">https://search.google.com/test/mobile-friendly?id=jyYcBViQ6HLVydDMtXn70g</p>

                <p><strong>Note 1:</strong> for experiments #4, #5, #6, and #7 no viewport was added in the mix since it will make the Mobile-Friendly test pass and thus skew our results.</p>

                <p><strong>Note 2:</strong> for all experiments very basic, plain and simple tests were done since the algorithm seems to have heuristics and a lot of specific use cases (no, it is not open-sourced).</p>

                <h4>Conclusions:</h4>
                <p>After running some interesting experiments and answering a lot of Google re-captchas (thought for a second that I was working for Google as a Neural Network Trainer) we can conclude the following for Google's "Mobile Friendly Test" tool.</p>
                <p>• Invisible text (same text color and background) will not be detected in the font size test.</p>
                <p>• Text with <code>opacity:0;</code> will not be detected in the font size test.</p>
                <p>• Always double check viewport tags in your pages. It's a low hanging fruit!</p>
                <p>• Text with <code>visibility:hidden;</code> will be detected in the font size test.</p>
                <p>• Text with <code>display:none;</code> will be detected in the font size test.</p>
                <p>• Would be nice if Google would open source this project so we can contribute to it since its very important specially for the fact given that the number of smartphone users will arise in the upcoming years.</p>
              </div>
            </section>
          </article>

        <!-- Footer -->
          <footer id="footer">
            <ul class="icons">

              <li><a href="https://es.linkedin.com/in/andrescastillo1" class="icon fa-linkedin"><span class="label">Linked-in</span></a></li>
              <li><a href="https://github.com/castilloandres" class="icon fa-github"><span class="label">Github</span></a></li>
              <li><a href="https://instagram.com/andrescastillo.es" class="icon fa-instagram"><span class="label">Instagram</span></a></li>
              <li><a href="mailto:castilloandres17@gmail.com" class="icon fa-envelope-o"><span class="label">Email</span></a></li>
              <li><a href="https://twitter.com/ndrscastillo" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
            </ul>
              <ul class="copyright">
              <li>&copy; Andres Castillo Ormaechea</li>
            </ul>

          </footer>

      </div>

    <!-- Scripts -->
      <script src="../../assets/js/jquery.min.js"></script>
      <script src="../../assets/js/jquery.scrollex.min.js"></script>
      <script src="../../assets/js/jquery.scrolly.min.js"></script>
      <script src="../../assets/js/skel.min.js"></script>
      <script src="../../assets/js/util.js"></script>
      <!--[if lte IE 8]><script src="../../assets/js/ie/respond.min.js"></script><![endif]-->
      <script src="../../assets/js/main.js"></script>

  </body>
</html>
